<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <title>VR Explorer</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="data:," />

  <style>
    html,body {
      height:100%;
      margin:0;
      background:#000;
      color:#fff;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;
    }

    .app {
      height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      padding:18px;
      box-sizing:border-box;
    }

    h1 {
      font-size:clamp(28px,6vw,48px);
      margin:8px 0;
    }

    h2 {
      font-size:18px;
      margin:6px 0 16px 0;
      color:#cbe7ff;
    }

    .controls {
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:flex-start;
      margin-bottom:18px;
      width:100%;
      max-width:300px;
    }

    label {
      font-size:14px;
      margin-bottom:4px;
      display:block;
    }

    select {
      width:100%;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.03);
      color:#fff;
      font-size:15px;
    }

    .footer {
      margin-top:auto;
      font-size:12px;
      font-style:italic;
      opacity:0.8;
      padding-bottom:6px;
    }

    .start-btn {
      margin-top:8px;
      padding:10px 14px;
      border-radius:10px;
      border:none;
      background:linear-gradient(90deg,#2b8bd6,#0066cc);
      color:white;
      font-weight:600;
      width:100%;
      text-align:center;
      cursor:pointer;
    }

    .player-wrap {
      position:fixed;
      inset:0;
      display:none;
      background:black;
      z-index:60;
      align-items:center;
      justify-content:center;
    }

    .player-toolbar {
      position:absolute;
      top:10px;
      left:10px;
      z-index:120;
    }

    .player-toolbar button {
      padding:8px 12px;
      border-radius:8px;
      border:none;
      background:rgba(255,255,255,0.08);
      color:#fff;
      cursor:pointer;
    }

    .cardboard {
      display:flex;
      width:100%;
      height:100%;
      overflow:hidden;
    }

    .cardboard iframe {
      flex:1;
      border:0;
      height:100%;
      width:50vw;
    }
  </style>
</head>

<body>
  <main class="app" id="app">
    <h1>VR Explorer</h1>
    <h2>Step 1: Select Simulation</h2>

    <div class="controls">
      <div>
        <label for="audience">Audience Sizes</label>
        <select id="audience"></select>
      </div>

      <div>
        <label for="scenarios">Special Scenarios</label>
        <select id="scenarios"></select>
      </div>

      <button id="openBtn" class="start-btn">Step 2: Open Simulation</button>
    </div>

    <div class="footer">VR Explorer 1.1 brought to you by Cambridge VR</div>
  </main>

  <div class="player-wrap" id="playerWrap">
    <div class="player-toolbar">
      <button id="exitBtn">Exit VR</button>
    </div>
    <div id="playerArea" class="cardboard"></div>
  </div>

  <script>
    const VIDEOS = {
      "Audience Sizes": [
        { title: 'Audience of 0', url: 'https://player.virtualrealitypublicspeaking.com/?video=N0-CF' },
        { title: 'Audience of 1', url: 'https://player.virtualrealitypublicspeaking.com/?video=N1-CF' },
        { title: 'Audience of 2', url: 'https://player.virtualrealitypublicspeaking.com/?video=N2-CF' },
        { title: 'Audience of 4', url: 'https://player.virtualrealitypublicspeaking.com/?video=N4-CF' },
        { title: 'Audience of 9', url: 'https://player.virtualrealitypublicspeaking.com/?video=N9-CF' },
        { title: 'Audience of 16', url: 'https://player.virtualrealitypublicspeaking.com/?video=N16-CF' },
        { title: 'Audience of 25', url: 'https://player.virtualrealitypublicspeaking.com/?video=N25-CF' },
        { title: 'Audience of 50', url: 'https://player.virtualrealitypublicspeaking.com/?video=N50-CF' },
        { title: 'Audience of 100', url: 'https://player.virtualrealitypublicspeaking.com/?video=N100-CF' },
        { title: 'Audience of 500', url: 'https://player.virtualrealitypublicspeaking.com/?video=N500-CF' },
        { title: 'Audience of 1000s', url: 'https://player.virtualrealitypublicspeaking.com/?video=N10K-CF' }
      ],
      "Special Scenarios": [
        { title: 'TV teleprompter', url: 'https://player.virtualrealitypublicspeaking.com/?video=ACC01-CF' },
        { title: 'Job interview', url: 'https://player.virtualrealitypublicspeaking.com/?video=JIC01-CF' },
        { title: 'Radio interview', url: 'https://player.virtualrealitypublicspeaking.com/?video=RIC01-CF' }
      ]
    };

    const audienceSel = document.getElementById('audience');
    const scenariosSel = document.getElementById('scenarios');

    VIDEOS["Audience Sizes"].forEach(v => {
      const o = document.createElement('option');
      o.value = v.url;
      o.textContent = v.title;
      audienceSel.appendChild(o);
    });

    VIDEOS["Special Scenarios"].forEach(v => {
      const o = document.createElement('option');
      o.value = v.url;
      o.textContent = v.title;
      scenariosSel.appendChild(o);
    });

    function getSelectedURL() {
      return audienceSel.value || scenariosSel.value;
    }

    const openBtn = document.getElementById('openBtn');
    const exitBtn = document.getElementById('exitBtn');
    const playerWrap = document.getElementById('playerWrap');
    const playerArea = document.getElementById('playerArea');

    openBtn.addEventListener('click', () => {
      const url = getSelectedURL();
      if (!url) {
        alert("Please select a simulation.");
        return;
      }
      openCardboard(url);
    });

    exitBtn.addEventListener('click', closeCardboard);

    function openCardboard(url) {
      playerArea.innerHTML = "";

      const left = document.createElement("iframe");
      const right = document.createElement("iframe");

      [left, right].forEach(f => {
        f.src = url;
        f.setAttribute("allow", "autoplay; fullscreen; accelerometer; gyroscope; xr-spatial-tracking");
      });

      playerArea.appendChild(left);
      playerArea.appendChild(right);

      playerWrap.style.display = "flex";

      if (playerWrap.requestFullscreen) {
        playerWrap.requestFullscreen().catch(() => {});
      }
    }

    function closeCardboard() {
      if (document.fullscreenElement) {
        document.exitFullscreen().catch(() => {});
      }

      playerWrap.style.display = "none";
      playerArea.innerHTML = "";
      window.scrollTo(0, 0);
    }

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>
</body>
</html>
